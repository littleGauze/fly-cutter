window.__require=function t(e,n,o){function i(c,a){if(!n[c]){if(!e[c]){var u=c.split("/");if(u=u[u.length-1],!e[u]){var s="function"==typeof __require&&__require;if(!a&&s)return s(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+c+"'")}}var f=n[c]={exports:{}};e[c][0].call(f.exports,function(t){return i(e[c][1][t]||t)},f,f.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({Game:[function(t,e,n){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Game");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=r.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statusLabel=null,e.knifeNode=null,e.targetArea=null,e.knifePrefab=null,e.knifeClip=null,e.knifeHitClip=null,e._gaming=!1,e._angle=90,e._level=1,e._counter=5,e._dir=1,e._knifeCounter=3,e._knifeBucketNode=null,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this._knifeBucketNode=cc.find("knifeBucket",this.targetArea),this.node.on("touchstart",this._onTouchStart,this),this.targetArea.zIndex=1,this._rotateTarget(),this._initKnife(),setInterval(function(){t._dir=Math.random()>.5?1:-1,t._angle=t._dir*(60+20*Math.random())},2e3)},e.prototype.onDestroy=function(){this.node.off("touchstart",this._onTouchStart,this)},e.prototype._rotateTarget=function(){var t=cc.sequence(cc.rotateBy(1,this._angle),cc.callFunc(this._rotateTarget.bind(this)));this.targetArea.runAction(t)},e.prototype._onTouchStart=function(){var t=this;if(!this._gaming){this._gaming=!0;var e=cc.sequence(cc.moveTo(.2,cc.v2(this.targetArea.x,this.targetArea.y-50)),cc.callFunc(function(){var e=cc.instantiate(t.knifePrefab),n=t.knifeNode.parent.convertToWorldSpaceAR(t.knifeNode.position);e.setPosition(t._knifeBucketNode.convertToNodeSpaceAR(n));var o=t.targetArea.angle%360;o>0&&(o=360-o),e.angle=Math.abs(o),t._knifeBucketNode.addChild(e),t._checkEnd(e),t.knifeNode.position=cc.v2(0,-300)}));this.knifeNode.runAction(e)}},e.prototype._checkEnd=function(t){for(var e=this,n=this._knifeBucketNode.children,o=function(o,r){var c=n[o];if(c!==t&&Math.abs(Math.abs(c.angle%360)-Math.abs(t.angle%360))<15){i._playKnifeHitSound();var a=i._knifeBucketNode.convertToWorldSpaceAR(c.position);c.removeFromParent(!1),c.setPosition(i.node.convertToNodeSpaceAR(a)),i.node.addChild(c);var u=cc.sequence(cc.spawn(cc.sequence(cc.moveBy(.2,cc.v2(-100*i._dir,-100)).easing(cc.easeExponentialOut()),cc.moveBy(.5,cc.v2(-200*i._dir,-1e3)).easing(cc.easeExponentialIn())),cc.rotateBy(1,180*i._dir)),cc.callFunc(function(){c.destroy(),cc.director.loadScene("game"),e._gaming=!1}));return c.runAction(u),{value:void 0}}},i=this,r=0,c=n.length;r<c;r++){var a=o(r);if("object"==typeof a)return a.value}this._counter--,this._playKnifeCutterSound(),this._counter<=0?setTimeout(function(){e._levelUp(),e._updateStatus(),e._gaming=!1},1e3):(this._gaming=!1,this._updateStatus())},e.prototype._playKnifeCutterSound=function(){cc.audioEngine.play(this.knifeClip,!1,1)},e.prototype._playKnifeHitSound=function(){cc.audioEngine.play(this.knifeHitClip,!1,1)},e.prototype._levelUp=function(){this._level++,this._knifeCounter+=1,this._counter=5,this._initKnife()},e.prototype._initKnife=function(){this._knifeBucketNode.removeAllChildren();for(var t=0;t<this._knifeCounter;t++){var e=cc.instantiate(this.knifePrefab);this._knifeBucketNode.addChild(e);var n=30+360*Math.random();e.angle=n+90;var o=50*Math.cos(cc.misc.degreesToRadians(n)),i=50*Math.sin(cc.misc.degreesToRadians(n));e.setPosition(o,i)}},e.prototype._updateStatus=function(){this.statusLabel.string="Knifes: "+this._counter+", Level: "+this._level},i([a(cc.Label)],e.prototype,"statusLabel",void 0),i([a(cc.Node)],e.prototype,"knifeNode",void 0),i([a(cc.Node)],e.prototype,"targetArea",void 0),i([a(cc.Prefab)],e.prototype,"knifePrefab",void 0),i([a(cc.AudioClip)],e.prototype,"knifeClip",void 0),i([a(cc.AudioClip)],e.prototype,"knifeHitClip",void 0),e=i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{}]},{},["Game"]);